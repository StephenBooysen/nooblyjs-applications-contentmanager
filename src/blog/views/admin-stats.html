<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stats - Medium</title>
    <link rel="stylesheet" href="css/medium-style.css">
    <link rel="stylesheet" href="css/admin-style.css">
    <link rel="stylesheet" href="css/stats-style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="header-left">
                <button class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="/applications/blog" class="logo">
                    <div class="logo-icon">M</div>
                    <span>Medium</span>
                </a>
            </div>

            <div class="header-center">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Search Medium" id="searchInput">
                </div>
            </div>

            <div class="header-right">
                <button class="btn-ghost btn-icon" onclick="window.location.href='/applications/blog/admin/write'">
                    <i class="fas fa-pen"></i>
                    <span>Write</span>
                </button>
                <button class="btn-ghost btn-icon">
                    <i class="fas fa-bell"></i>
                </button>
                <div class="user-menu">
                    <img src="https://via.placeholder.com/32" alt="User" class="user-avatar" onclick="toggleUserMenu()">
                    <div class="user-dropdown" id="userDropdown">
                        <a href="/applications/blog/admin/stories" class="dropdown-item">
                            <i class="fas fa-file-alt"></i>
                            Stories
                        </a>
                        <a href="/applications/blog/admin/stats" class="dropdown-item">
                            <i class="fas fa-chart-line"></i>
                            Stats
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            Sign out
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Admin Sidebar -->
    <aside class="admin-sidebar">
        <nav class="admin-nav">
            <a href="/applications/blog" class="admin-nav-item">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="/applications/blog" class="admin-nav-item">
                <i class="fas fa-book-open"></i>
                <span>Library</span>
            </a>
            <a href="/applications/blog/admin/stories" class="admin-nav-item">
                <i class="fas fa-file-alt"></i>
                <span>Stories</span>
            </a>
            <a href="/applications/blog/admin/stats" class="admin-nav-item active">
                <i class="fas fa-chart-line"></i>
                <span>Stats</span>
            </a>
        </nav>

        <div class="admin-sidebar-bottom">
            <div class="sidebar-section">
                <h4>Discover more writers and publications to follow</h4>
                <a href="#" class="see-more-link">See suggestions</a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="admin-main-content">
        <div class="admin-content-header">
            <div class="admin-header-left">
                <h1>Stats</h1>
                <div class="stats-date-range">
                    <select id="dateRangeSelect" class="date-range-select">
                        <option value="7">Last 7 days</option>
                        <option value="30" selected>Last 30 days</option>
                        <option value="90">Last 90 days</option>
                        <option value="365">Last year</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Stats Overview Cards -->
        <div class="stats-content">
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalViews">0</div>
                        <div class="stat-label">Views</div>
                        <div class="stat-change positive" id="viewsChange">+0%</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalReaders">0</div>
                        <div class="stat-label">Readers</div>
                        <div class="stat-change positive" id="readersChange">+0%</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="readTime">0m</div>
                        <div class="stat-label">Read time</div>
                        <div class="stat-change positive" id="readTimeChange">+0%</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalClaps">0</div>
                        <div class="stat-label">Claps</div>
                        <div class="stat-change positive" id="clapsChange">+0%</div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="stats-charts">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Views over time</h3>
                        <div class="chart-legend">
                            <span class="legend-item">
                                <div class="legend-color primary"></div>
                                Views
                            </span>
                            <span class="legend-item">
                                <div class="legend-color secondary"></div>
                                Reads
                            </span>
                        </div>
                    </div>
                    <div class="chart" id="viewsChart">
                        <canvas id="viewsChartCanvas" width="800" height="300"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3>Top stories</h3>
                    </div>
                    <div class="top-stories" id="topStories">
                        <!-- Top stories will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Detailed Stats Tables -->
            <div class="stats-tables">
                <div class="table-container">
                    <div class="table-header">
                        <h3>Story performance</h3>
                        <div class="table-filters">
                            <select id="sortBy" class="table-select">
                                <option value="views">Sort by views</option>
                                <option value="reads">Sort by reads</option>
                                <option value="claps">Sort by claps</option>
                                <option value="comments">Sort by comments</option>
                            </select>
                        </div>
                    </div>
                    <div class="stats-table">
                        <table id="storyPerformanceTable">
                            <thead>
                                <tr>
                                    <th>Story</th>
                                    <th>Views</th>
                                    <th>Reads</th>
                                    <th>Read ratio</th>
                                    <th>Claps</th>
                                    <th>Comments</th>
                                    <th>Published</th>
                                </tr>
                            </thead>
                            <tbody id="performanceTableBody">
                                <!-- Story performance data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h3>Referrers</h3>
                    </div>
                    <div class="referrers-list" id="referrersList">
                        <!-- Referrer data will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Audience Insights -->
            <div class="audience-insights">
                <div class="insight-container">
                    <div class="insight-header">
                        <h3>Audience insights</h3>
                    </div>
                    <div class="insights-grid">
                        <div class="insight-card">
                            <h4>Countries</h4>
                            <div class="insight-list" id="countryInsights">
                                <!-- Country data will be loaded here -->
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4>Reading times</h4>
                            <div class="insight-chart" id="readingTimesChart">
                                <!-- Reading times chart will be loaded here -->
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4>Most popular tags</h4>
                            <div class="insight-list" id="popularTags">
                                <!-- Popular tags will be loaded here -->
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4>Growth metrics</h4>
                            <div class="growth-metrics" id="growthMetrics">
                                <!-- Growth metrics will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>Loading stats...</p>
    </div>

    <script src="js/admin-stats.js"></script>
</body>
</html>