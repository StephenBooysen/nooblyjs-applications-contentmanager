<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Site Builder - CMS</title>
    <link rel="stylesheet" href="/applications/cms/css/builder.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.css">
</head>
<body>
    <div class="builder-container">
        <!-- Top Toolbar -->
        <header class="builder-toolbar">
            <div class="toolbar-left">
                <button class="btn btn-ghost" onclick="window.history.back()">
                    <i class="fas fa-arrow-left"></i>
                    Back
                </button>
                <div class="site-info">
                    <h1 id="site-name">Site Builder</h1>
                    <span id="page-name" class="page-name">Home Page</span>
                </div>
            </div>

            <div class="toolbar-center">
                <div class="device-toggle">
                    <button class="device-btn active" data-device="desktop" title="Desktop View">
                        <i class="fas fa-desktop"></i>
                    </button>
                    <button class="device-btn" data-device="tablet" title="Tablet View">
                        <i class="fas fa-tablet-alt"></i>
                    </button>
                    <button class="device-btn" data-device="mobile" title="Mobile View">
                        <i class="fas fa-mobile-alt"></i>
                    </button>
                </div>
            </div>

            <div class="toolbar-right">
                <button class="btn btn-outline" onclick="previewSite()">
                    <i class="fas fa-eye"></i>
                    Preview
                </button>
                <button class="btn btn-outline" onclick="savePage()">
                    <i class="fas fa-save"></i>
                    Save
                </button>
                <button class="btn btn-primary" onclick="publishSite()">
                    <i class="fas fa-rocket"></i>
                    Publish
                </button>
                <div class="user-menu">
                    <button class="btn btn-ghost" onclick="toggleUserMenu()">
                        <i class="fas fa-user-circle"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Builder Interface -->
        <div class="builder-main">
            <!-- Left Sidebar - Components -->
            <aside class="builder-sidebar left">
                <div class="sidebar-header">
                    <h3>Components</h3>
                    <button class="sidebar-toggle" onclick="toggleSidebar('left')">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                </div>

                <div class="sidebar-content">
                    <!-- Search Components -->
                    <div class="search-box">
                        <input type="text" id="component-search" placeholder="Search components...">
                        <i class="fas fa-search"></i>
                    </div>

                    <!-- Component Categories -->
                    <div class="component-categories">
                        <div class="category-tabs">
                            <button class="category-tab active" data-category="all">All</button>
                            <button class="category-tab" data-category="headers">Headers</button>
                            <button class="category-tab" data-category="content">Content</button>
                            <button class="category-tab" data-category="media">Media</button>
                            <button class="category-tab" data-category="forms">Forms</button>
                        </div>

                        <!-- Component List -->
                        <div class="components-list" id="components-list">
                            <div class="component-item" draggable="true" data-component="hero">
                                <div class="component-icon">
                                    <i class="fas fa-mountain"></i>
                                </div>
                                <div class="component-info">
                                    <h4>Hero Section</h4>
                                    <p>Eye-catching header with title and CTA</p>
                                </div>
                            </div>

                            <div class="component-item" draggable="true" data-component="text">
                                <div class="component-icon">
                                    <i class="fas fa-align-left"></i>
                                </div>
                                <div class="component-info">
                                    <h4>Text Block</h4>
                                    <p>Rich text content with formatting</p>
                                </div>
                            </div>

                            <div class="component-item" draggable="true" data-component="gallery">
                                <div class="component-icon">
                                    <i class="fas fa-images"></i>
                                </div>
                                <div class="component-info">
                                    <h4>Image Gallery</h4>
                                    <p>Showcase multiple images in a grid</p>
                                </div>
                            </div>

                            <div class="component-item" draggable="true" data-component="contact">
                                <div class="component-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="component-info">
                                    <h4>Contact Form</h4>
                                    <p>Simple contact form with validation</p>
                                </div>
                            </div>

                            <div class="component-item" draggable="true" data-component="feature">
                                <div class="component-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="component-info">
                                    <h4>Feature Grid</h4>
                                    <p>Highlight key features or services</p>
                                </div>
                            </div>

                            <div class="component-item" draggable="true" data-component="testimonial">
                                <div class="component-icon">
                                    <i class="fas fa-quote-left"></i>
                                </div>
                                <div class="component-info">
                                    <h4>Testimonials</h4>
                                    <p>Customer reviews and testimonials</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Center Canvas -->
            <main class="builder-canvas">
                <div class="canvas-container" id="canvas-container">
                    <div class="canvas-wrapper" data-device="desktop">
                        <iframe id="preview-frame" src="about:blank" frameborder="0"></iframe>

                        <!-- Drop Zone Overlay -->
                        <div class="drop-zone-overlay" id="drop-zone">
                            <div class="drop-zone-content">
                                <i class="fas fa-plus-circle"></i>
                                <p>Drag components here to start building</p>
                            </div>
                        </div>

                        <!-- Page Sections -->
                        <div class="page-sections" id="page-sections">
                            <!-- Sections will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <!-- Canvas Footer -->
                <div class="canvas-footer">
                    <div class="zoom-controls">
                        <button class="zoom-btn" onclick="zoomOut()">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <span class="zoom-level" id="zoom-level">100%</span>
                        <button class="zoom-btn" onclick="zoomIn()">
                            <i class="fas fa-search-plus"></i>
                        </button>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar - Properties -->
            <aside class="builder-sidebar right">
                <div class="sidebar-header">
                    <h3>Properties</h3>
                    <button class="sidebar-toggle" onclick="toggleSidebar('right')">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="sidebar-content">
                    <div id="properties-panel">
                        <!-- Properties will be dynamically loaded here -->
                        <div class="no-selection">
                            <i class="fas fa-mouse-pointer"></i>
                            <p>Select a component to edit its properties</p>
                        </div>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Floating Action Menu -->
        <div class="floating-menu" id="floating-menu">
            <button class="fab-main" onclick="toggleFloatingMenu()">
                <i class="fas fa-plus"></i>
            </button>
            <div class="fab-options">
                <button class="fab-option" onclick="addSection()" title="Add Section">
                    <i class="fas fa-layer-group"></i>
                </button>
                <button class="fab-option" onclick="showAssetsLibrary()" title="Assets Library">
                    <i class="fas fa-images"></i>
                </button>
                <button class="fab-option" onclick="showPageSettings()" title="Page Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- Component Properties Modal -->
    <div class="modal" id="component-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Component Properties</h2>
                <button class="modal-close" onclick="closeModal('component-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('component-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveComponentProperties()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Assets Library Modal -->
    <div class="modal" id="assets-modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2>Assets Library</h2>
                <button class="modal-close" onclick="closeModal('assets-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="assets-toolbar">
                    <button class="btn btn-primary" onclick="uploadAsset()">
                        <i class="fas fa-upload"></i>
                        Upload Assets
                    </button>
                    <div class="assets-search">
                        <input type="text" placeholder="Search assets...">
                        <i class="fas fa-search"></i>
                    </div>
                </div>
                <div class="assets-grid" id="assets-grid">
                    <!-- Assets will be loaded dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Page Settings Modal -->
    <div class="modal" id="page-settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Page Settings</h2>
                <button class="modal-close" onclick="closeModal('page-settings-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="page-settings-form">
                    <div class="form-group">
                        <label for="page-title">Page Title</label>
                        <input type="text" id="page-title" name="title" placeholder="Enter page title">
                    </div>
                    <div class="form-group">
                        <label for="page-slug">URL Slug</label>
                        <input type="text" id="page-slug" name="slug" placeholder="page-url">
                    </div>
                    <div class="form-group">
                        <label for="meta-description">Meta Description</label>
                        <textarea id="meta-description" name="metaDescription" rows="3" placeholder="Page description for SEO"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="meta-keywords">Keywords</label>
                        <input type="text" id="meta-keywords" name="keywords" placeholder="keyword1, keyword2, keyword3">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('page-settings-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="savePageSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p id="loading-message">Loading...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="/applications/cms/js/builder.js"></script>
    <script>
        // Initialize the site builder
        document.addEventListener('DOMContentLoaded', function() {
            window.siteBuilder = new SiteBuilder();
            siteBuilder.init();
        });
    </script>
</body>
</html>